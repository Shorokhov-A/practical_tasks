Все 3 задачи решены в полном объеме.
Было не так просто, как показалось на первый взгляд.
Конструктивная критика принимается.